##
# this is a default config file for a simple php site
##

# ssl_certificate      /etc/ssl/certs/key_name.crt;
# ssl_certificate_key  /etc/ssl/private/key_name.key;

#server {
#  listen  80;
#  server_name *.localhost;
#  rewrite ^ $scheme://<%= node[:nginx][:server_name] %>$request_uri permanent;
#}

server {

  # address a bug in Virtualbox and shared folders
  # http://serverfault.com/questions/269420/
  sendfile off;

  listen  80;
  # listen  443 default_server ssl;

  charset utf-8;
  server_name <%= node[:nginx][:server_name] %>;
  root <%= node[:nginx][:root] %>;
  index index.php index.htm index.html;

  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;

  location / {
    try_files $uri $uri/ /index.php?$args;
  }

  # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
  location ~ \.php$ {
    include fastcgi_params;
    fastcgi_index index.php;
    fastcgi_pass <%= node[:nginx][:socket] %>;
  }

  # deny access to .htaccess files
  location ~ /\.ht {
    deny all;
  }

}
